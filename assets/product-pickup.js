class ProductPickup extends HTMLElement{constructor(){super()}connectedCallback(){this.init="true"===this.getAttribute("data-load-first-variant"),this.product_title=this.getAttribute("data-title"),this.pickup_drawer_container=theme.drawer.querySelector('.drawer--container[data-view="pickup"]'),this.initPickup(),this.updatePickupListener()}initPickup(){this.init?this.getPickupForm(this.dataset.firstVariantId):this.parentNode.setAttribute("data-empty",!0)}updatePickupListener(){window.on(`theme:product:${this.dataset.id}:variantChanged`,({detail:{variant:t}})=>{t.available&&"shopify"===t.inventory_management?this.getPickupForm(t.id):t&&"shopify"===t.inventory_management&&t.available||this.removeOldForm()})}async getPickupForm(t){this.setAttribute("data-loading",!0);var e=await fetch(theme.urls.root+`/variants/${t}/?section_id=pickup`);if(!e.ok)throw new Error(e.statusText);var i,r=await e.text(),a=theme.utils.parseHtml(r,".pickup--form--container");this.removeOldForm(),this.setAttribute("data-loading",!1),a&&(this.appendChild(a),this.parentNode.setAttribute("data-empty",!1),(i=theme.utils.parseHtml(r,".pickup--drawer--container")).querySelector(".pickup--drawer--product-title").innerText=this.product_title,"true"===this.getAttribute("data-is-only-variant")&&(i.querySelector(".pickup--drawer--variant-title").style.display="none"),this.pickup_drawer_container.appendChild(i),theme.drawer.loadTriggers())}removeOldForm(){this.parentNode.setAttribute("data-empty",!0),this.pickup_drawer_container.innerHTML="",this.innerHTML=""}}const productPickupEl=customElements.get("product-pickup-root");productPickupEl||customElements.define("product-pickup-root",ProductPickup);