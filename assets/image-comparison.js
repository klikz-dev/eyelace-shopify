class ImageComparisonSection extends HTMLElement{constructor(){super(),this.container=this.querySelector(".image-comparison--images"),this.cursor=this.querySelector(".image-comparison--cursor"),this.direction=this.getAttribute("data-cursor-direction")}connectedCallback(){this.transitionObserver(),this.getDimensions(),this.cursorListeners(),this.resizeObserver()}transitionObserver(){this.on("transitionend",({target:e})=>{e===this.cursor.parentNode&&(this.style.setProperty("--image-comparison--transition","none"),this.off("transitionend"))}),new IntersectionObserver(([{isIntersecting:e}],t)=>{e&&(t.disconnect(),this.setCursor(this.getAttribute("data-initial-pos")))},{threshold:.3}).observe(this.container)}setCursor(e){this.style.setProperty("--image-comparison--cursor-pos",e+"%")}getDimensions(){this.total="horizontal"===this.direction?this.container.offsetWidth:this.container.offsetHeight,this.offset="horizontal"===this.direction?this.container.offset().left:this.container.offset().top}resizeObserver(){new ResizeObserver(()=>this.getDimensions()).observe(this)}cursorListeners(){const t="vertical"===this.direction&&theme.utils.isTouchDevice;this.cursor.on("mousedown touchstart",()=>{this.cursor.style.cursor="grabbing",theme.utils.disable_swipe_listener=!0},{passive:!0}),window.on("mousemove touchmove",e=>{theme.utils.disable_swipe_listener&&(t&&e.preventDefault(),this.animation_request&&cancelAnimationFrame(this.animation_request),this.animation_request=requestAnimationFrame(()=>this.moveCursor(e)))},{passive:!t}),window.on("mouseup touchend",()=>{theme.utils.disable_swipe_listener&&(this.cursor.style.cursor="unset",theme.utils.disable_swipe_listener=!1)},{passive:!0})}moveCursor(e){let t,s=("horizontal"===this.direction?t=("touchmove"===e.type?e.targetTouches[0]:e).pageX:"vertical"===this.direction&&(t=("touchmove"===e.type?e.targetTouches[0]:e).pageY),(100*(t-this.offset)/this.total).toFixed(2));95<s?s=95:s<5&&(s=5),this.setCursor(s)}}const imageComparisonEl=customElements.get("image-comparison");imageComparisonEl||customElements.define("image-comparison",ImageComparisonSection);