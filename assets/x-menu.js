class XMenu extends HTMLElement{constructor(){super()}connectedCallback(){this.parent_links=this.querySelectorAll(".x-menu--level-1--link > a"),this.sub_menu_links=this.querySelectorAll('.x-menu--level-1--link:not([data-x-menu--depth="1"]) > a'),this.overlap_parent=parseInt(this.getAttribute("data-x-menu--overlap-parent")),this.header_root=document.querySelector(".header--root"),this.sub_menu_items=[],this.parents_with_sub_menu=[],this.sub_menu_links.forEach(e=>{var t=e.parentNode;this.parents_with_sub_menu.push(t),e.parentNode.querySelectorAll("ul a").forEach(e=>this.sub_menu_items.push(e))}),this.state="closed",this.load()}disconnectedCallback(){this.parent_links.off("focus.XMenu"),this.sub_menu_links.off("touchstart.XMenu focus.XMenu"),this.parents_with_sub_menu.off("mouseleave.XMenu"),this.parents_with_sub_menu.forEach(e=>{e.querySelectorAll(":scope > a").off("mouseenter.XMenu")})}load(){this.arrangeMegaNav(),this.listeners(),this.checkOverlap(),this.resizeObserver()}listeners(){this.parents_with_sub_menu.forEach(e=>{e.querySelectorAll(":scope > a").on("mouseenter.XMenu",e=>this.slideDown(e.target))}),this.parents_with_sub_menu.on("mouseleave.XMenu",()=>this.slideUp()),this.parent_links.on("focus.XMenu",()=>this.slideUp),this.sub_menu_links.on("focus.XMenu",e=>this.slideDown(e.target)),this.sub_menu_links.on("touchstart.XMenu",e=>{e.preventDefault(),"true"===e.target.parentNode.getAttribute("data-x-menu--open")?this.slideUp(!1):this.slideDown(e.target)},{passive:!0})}checkOverlap(){if(theme.utils.isTouchDevice&&"large"!==theme.mqs.current_window)return this.setAttribute("data-x-menu--overlap",!0),this.header_root.setAttribute("data-x-menu--overlap",!0),window.trigger("theme:XMenu:loaded"),!1;this.setAttribute("data-x-menu--overlap",!1),this.header_root.setAttribute("data-x-menu--overlap",!1);let e=this;1===this.overlap_parent?e=e.parentNode:2===this.overlap_parent&&(e=e.parentNode.parentNode);var t,r,s,n,a=e.parentNode,i=e.index();let o=!1,l=(1<i&&(o=a.children[i-1]),!1);i+1<a.children.length&&(l=a.children[i+1]),o&&(r=(t=o.querySelector(":scope > :last-child")).offset().left+t.offsetWidth,e.offset().left-1<=r)&&(this.setAttribute("data-x-menu--overlap",!0),this.header_root.setAttribute("data-x-menu--overlap",!0)),l&&(n=(s=e.querySelector(":scope > :last-child")).offset().left+s.offsetWidth,l.offset().left-1<=n)&&(this.setAttribute("data-x-menu--overlap",!0),this.header_root.setAttribute("data-x-menu--overlap",!0)),window.trigger("theme:XMenu:loaded")}resizeObserver(){new ResizeObserver(()=>this.checkOverlap()).observe(this.header_root)}arrangeMegaNav(){var e=this.querySelectorAll(".x-menu--single-parents");0===this.parents_with_sub_menu.length||0<e.length||this.querySelectorAll('[data-x-menu--depth="3"] .x-menu--level-2--container').forEach(e=>{var t=e.querySelectorAll('[data-x-menu--single-parent="true"]');if(t.length){const s=new DocumentFragment;t.forEach(e=>s.appendChild(e));var r=theme.utils.parseHtml('<div class="x-menu--single-parents"><ul></ul></div>');r.querySelector("ul").appendChild(s),e.prepend(r)}})}slideDown(e,t=!1){clearTimeout(this.timer);var r=e.parentNode;if("true"===r.getAttribute("data-x-menu--open"))return!1;if(this.slideUp(!1),t&&"complete"!==t)this.timer=setTimeout(()=>this.slideDown(e,"complete"),t);else{r.setAttribute("data-x-menu--open",!0),e.setAttribute("aria-expanded",!0),this.state="opened";const s=r.querySelector(".x-menu--level-2--container");s&&(s.removeAttribute("style"),setTimeout(()=>s.setAttribute("aria-hidden",!1),0))}}slideUp(e=300){let t=!1,r=!1,s;for(let n=0;n<this.parents_with_sub_menu.length;n++)if("true"===(s=this.parents_with_sub_menu[n]).getAttribute("data-x-menu--open")){r=s,t=r.querySelector(":scope > a");break}if(r)if(e)this.timer=setTimeout(()=>this.slideUp(!1),e);else{r.setAttribute("data-x-menu--open",!1),t&&t.setAttribute("aria-expanded",!1),this.state="closing";const a=r.querySelector(".x-menu--level-2--container");a&&(a.setAttribute("aria-hidden",!0),a.on("transitionend",()=>{"closing"===this.state&&(this.state="closed",a.style.display="none")},{once:!0}))}}}class XMenuExtension extends XMenu{connectedCallback(){this.hide_when_overlapping=document.querySelectorAll(".header--root .layout--login, .header--root .header--cart-link, .header--root .header--search"),super.connectedCallback()}load(){super.load(),this.alignSubmenus()}alignSubmenus(){const t=document.querySelector(".header--root .logo--root").offsetWidth;var e=this.querySelectorAll('[data-x-menu--depth="3"] .x-menu--level-2--container');e.length&&e.forEach(e=>{e.style.left=t+"px",e.style.width=`calc(100% - ${t}px)`})}checkOverlap(){var e=document.querySelector(".header--root");e.setAttribute("data-menu-overlap",!1),this.hide_when_overlapping.forEach(e=>e.removeAttribute("style")),super.checkOverlap(),"true"===this.getAttribute("data-x-menu--overlap")&&(e.setAttribute("data-menu-overlap",!0),this.hide_when_overlapping.forEach(e=>e.style.display="none"))}}customElements.define("x-menu-root",XMenuExtension);